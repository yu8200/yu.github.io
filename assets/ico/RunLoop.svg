<svg id="kity_svg_6" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1436" height="2252" style="background: rgb(251, 251, 251); visibility: visible;" viewBox="0 0 1436 2252"><defs id="kity_defs_7"><linearGradient id="kity_linearGradient_17" x1="0" y1="0" x2="0" y2="1"><stop id="kity_stop_18" offset="0" stop-color="rgb(255, 255, 255)"></stop><stop id="kity_stop_19" offset="1" stop-color="rgb(204, 204, 204)"></stop></linearGradient><marker id="kity_marker_2" orient="auto" refX="6" refY="0" viewBox="-7 -7 14 14" markerWidth="7" markerHeight="7" markerUnits="userSpaceOnUse"><path id="kity_path_3" fill="rgb(115, 161, 191)" stroke="none" d="M6,0A6,6,0,1,1,-6,0A6,6,0,1,1,6,0"></path></marker></defs><g id="kity_g_8"><g id="minder1" text-rendering="optimize-speed"><g id="minder_connect_group1"><path id="kity_path_31" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M78.5,1122.5A176,675,0,0,1,254.5,447.5"></path><path id="kity_path_33" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M400.5,447.5C420.5,447.5,420.5,161.5,440.5,161.5"></path><path id="kity_path_35" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M484.5,161.5C504.5,161.5,504.5,31.5,524.5,31.5"></path><path id="kity_path_37" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M484.5,161.5C504.5,161.5,504.5,83.5,524.5,83.5"></path><path id="kity_path_39" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M484.5,161.5C504.5,161.5,504.5,135.5,524.5,135.5"></path><path id="kity_path_41" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M484.5,161.5C504.5,161.5,504.5,187.5,524.5,187.5"></path><path id="kity_path_43" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M484.5,161.5C504.5,161.5,504.5,239.5,524.5,239.5"></path><path id="kity_path_45" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M484.5,161.5C504.5,161.5,504.5,291.5,524.5,291.5"></path><path id="kity_path_47" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M400.5,447.5C420.5,447.5,420.5,499.5,440.5,499.5"></path><path id="kity_path_49" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M484.5,499.5C504.5,499.5,504.5,343.5,524.5,343.5"></path><path id="kity_path_51" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M664.5,343.5C684.5,343.5,684.5,343.5,704.5,343.5"></path><path id="kity_path_53" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M484.5,499.5C504.5,499.5,504.5,519.5,524.5,519.5"></path><path id="kity_path_55" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M651.5,519.5C671.5,519.5,671.5,435.5,691.5,435.5"></path><path id="kity_path_57" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M825.5,435.5C845.5,435.5,845.5,396.5,865.5,396.5"></path><path id="kity_path_59" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M825.5,435.5C845.5,435.5,845.5,474.5,865.5,474.5"></path><path id="kity_path_61" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M933.5,474.5C953.5,474.5,953.5,448.5,973.5,448.5"></path><path id="kity_path_63" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M933.5,474.5C953.5,474.5,953.5,500.5,973.5,500.5"></path><path id="kity_path_65" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M651.5,519.5C671.5,519.5,671.5,552.5,691.5,552.5"></path><path id="kity_path_67" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M825.5,552.5C845.5,552.5,845.5,552.5,865.5,552.5"></path><path id="kity_path_69" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M651.5,519.5C671.5,519.5,671.5,604.5,691.5,604.5"></path><path id="kity_path_71" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M484.5,499.5C504.5,499.5,504.5,655.5,524.5,655.5"></path><path id="kity_path_73" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M641.5,655.5C661.5,655.5,661.5,655.5,681.5,655.5"></path><path id="kity_path_75" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M400.5,447.5C420.5,447.5,420.5,733.5,440.5,733.5"></path><path id="kity_path_77" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M519.5,733.5C539.5,733.5,539.5,707.5,559.5,707.5"></path><path id="kity_path_79" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M519.5,733.5C539.5,733.5,539.5,759.5,559.5,759.5"></path><path id="kity_path_81" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M78.5,1122.5A162,285,0,0,1,240.5,837.5"></path><path id="kity_path_83" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M328.5,837.5C348.5,837.5,348.5,837.5,368.5,837.5"></path><path id="kity_path_85" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M78.5,1122.5A261,129,0,0,1,339.5,993.5"></path><path id="kity_path_97" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M78.5,1122.5A176,113,0,0,0,254.5,1235.5"></path><path id="kity_path_99" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M436.5,1235.5C456.5,1235.5,456.5,1157.5,476.5,1157.5"></path><path id="kity_path_101" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M436.5,1235.5C456.5,1235.5,456.5,1209.5,476.5,1209.5"></path><path id="kity_path_103" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M436.5,1235.5C456.5,1235.5,456.5,1261.5,476.5,1261.5"></path><path id="kity_path_105" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M436.5,1235.5C456.5,1235.5,456.5,1313.5,476.5,1313.5"></path><path id="kity_path_335" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M78.5,1122.5A176,676,0,0,0,254.5,1798.5"></path><path id="kity_path_400" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M408.5,1798.5C428.5,1798.5,428.5,1402.5,448.5,1402.5"></path><path id="kity_path_424" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M408.5,1798.5C428.5,1798.5,428.5,1490.5,448.5,1490.5"></path><path id="kity_path_432" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M408.5,1798.5C428.5,1798.5,428.5,1569.5,448.5,1569.5"></path><path id="kity_path_440" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M408.5,1798.5C428.5,1798.5,428.5,1657.5,448.5,1657.5"></path><path id="kity_path_448" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M408.5,1798.5C428.5,1798.5,428.5,1745.5,448.5,1745.5"></path><path id="kity_path_456" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M408.5,1798.5C428.5,1798.5,428.5,1824.5,448.5,1824.5"></path><path id="kity_path_464" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M408.5,1798.5C428.5,1798.5,428.5,1894.5,448.5,1894.5"></path><path id="kity_path_500" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M408.5,1798.5C428.5,1798.5,428.5,1964.5,448.5,1964.5"></path><path id="kity_path_515" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M408.5,1798.5C428.5,1798.5,428.5,2070.5,448.5,2070.5"></path><path id="kity_path_530" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M408.5,1798.5C428.5,1798.5,428.5,2194.5,448.5,2194.5"></path><path id="kity_path_542" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M437.5,993.5C457.5,993.5,457.5,889.5,477.5,889.5"></path><path id="kity_path_543" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M437.5,993.5C457.5,993.5,457.5,941.5,477.5,941.5"></path><path id="kity_path_544" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M437.5,993.5C457.5,993.5,457.5,993.5,477.5,993.5"></path><path id="kity_path_545" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M437.5,993.5C457.5,993.5,457.5,1045.5,477.5,1045.5"></path><path id="kity_path_546" fill="none" stroke="rgb(115, 161, 191)" stroke-width="1" d="M437.5,993.5C457.5,993.5,457.5,1097.5,477.5,1097.5"></path></g><g id="minder_node1"><path id="node_outline1" fill="rgb(115, 161, 191)" stroke="rgb(115, 161, 191)" d="M25.5,1102.5h106a5,5,0,0,1,5,5v30a5,5,0,0,1,-5,5h-106a5,5,0,0,1,-5,-5v-30a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text1" fill="white"><text id="kity_text_22" text-rendering="inherit" font-size="16" dy=".8em" y="1114.5" x="44.5">RunLoop</text></g></g><g id="kity_g_14" display="none"><path id="kity_path_15" fill="none" stroke="none" d="M44.5,1122.5h0v0h0z"></path><path id="kity_path_16" fill="none" stroke="none"></path></g><g id="minder_node2"><g id="node_expander25" style="cursor: pointer;"><path id="kity_path_293" fill="white" stroke="gray" d="M255.5,447.5A6,6,0,1,1,243.5,447.5A6,6,0,1,1,255.5,447.5"></path><path id="kity_path_294" fill="none" stroke="gray" d="M245,447.5L254,447.5"></path></g><path id="node_outline26" fill="rgb(238, 243, 246)" stroke="rgb(115, 161, 191)" d="M259.5,434.5h138a3,3,0,0,1,3,3v20a3,3,0,0,1,-3,3h-138a3,3,0,0,1,-3,-3v-20a3,3,0,0,1,3,-3z" stroke-width="1"></path><g id="node_text26" fill="black"><text id="kity_text_155" text-rendering="inherit" font-size="14" dy=".8em" y="440.5" x="276.5">RunLoop Mode</text></g></g><g id="minder_node3"><g id="node_expander7" style="cursor: pointer;"><path id="kity_path_239" fill="white" stroke="gray" d="M440.5,161.5A6,6,0,1,1,428.5,161.5A6,6,0,1,1,440.5,161.5"></path><path id="kity_path_240" fill="none" stroke="gray" d="M430,161.5L439,161.5"></path></g><path id="node_outline8" fill="none" stroke="none" d="M445.5,150.5h34a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-34a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text8" fill="black"><text id="kity_text_119" text-rendering="inherit" font-size="12" dy=".8em" y="155.5" x="450.5">原理</text></g></g><g id="minder_node4"><g id="node_expander1" style="cursor: pointer;" display="none"><path id="kity_path_221" fill="white" stroke="gray" d="M524.5,31.5A6,6,0,1,1,512.5,31.5A6,6,0,1,1,524.5,31.5"></path><path id="kity_path_222" fill="none" stroke="gray"></path></g><path id="node_outline2" fill="none" stroke="none" d="M529.5,20.5h244a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-244a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text2" fill="black"><text id="kity_text_107" text-rendering="inherit" font-size="12" dy=".8em" y="25.5" x="534.5">CFRunLoop里面包含了线程，若干个mode</text></g></g><g id="minder_node5"><g id="node_expander2" style="cursor: pointer;" display="none"><path id="kity_path_224" fill="white" stroke="gray" d="M524.5,83.5A6,6,0,1,1,512.5,83.5A6,6,0,1,1,524.5,83.5"></path><path id="kity_path_225" fill="none" stroke="gray"></path></g><path id="node_outline3" fill="none" stroke="none" d="M529.5,72.5h304a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-304a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text3" fill="black"><text id="kity_text_109" text-rendering="inherit" font-size="12" dy=".8em" y="77.5" x="534.5">RunLoop mode中包含了sources、timers和observers</text></g></g><g id="minder_node6"><g id="node_expander3" style="cursor: pointer;" display="none"><path id="kity_path_227" fill="white" stroke="gray" d="M524.5,135.5A6,6,0,1,1,512.5,135.5A6,6,0,1,1,524.5,135.5"></path><path id="kity_path_228" fill="none" stroke="gray"></path></g><path id="node_outline4" fill="none" stroke="none" d="M529.5,124.5h228a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-228a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text4" fill="black"><text id="kity_text_111" text-rendering="inherit" font-size="12" dy=".8em" y="129.5" x="534.5">每次启动RunLoop都必须指定一个Mode</text></g></g><g id="minder_node7"><g id="node_expander4" style="cursor: pointer;" display="none"><path id="kity_path_230" fill="white" stroke="gray" d="M524.5,187.5A6,6,0,1,1,512.5,187.5A6,6,0,1,1,524.5,187.5"></path><path id="kity_path_231" fill="none" stroke="gray"></path></g><path id="node_outline5" fill="none" stroke="none" d="M529.5,176.5h685a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-685a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text5" fill="black"><text id="kity_text_113" text-rendering="inherit" font-size="12" dy=".8em" y="181.5" x="534.5">在RunLoop运行过程中，只有当前Mode中的事件会被处理，其他Mode中的事件会被暂停，直到该RunLoop在该Mode下运行</text></g></g><g id="minder_node8"><g id="node_expander5" style="cursor: pointer;" display="none"><path id="kity_path_233" fill="white" stroke="gray" d="M524.5,239.5A6,6,0,1,1,512.5,239.5A6,6,0,1,1,524.5,239.5"></path><path id="kity_path_234" fill="none" stroke="gray"></path></g><path id="node_outline6" fill="none" stroke="none" d="M529.5,228.5h294a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-294a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text6" fill="black"><text id="kity_text_115" text-rendering="inherit" font-size="12" dy=".8em" y="233.5" x="534.5">你可以通过name来标识Mode，name是一个字符串</text></g></g><g id="minder_node9"><g id="node_expander6" style="cursor: pointer;" display="none"><path id="kity_path_236" fill="white" stroke="gray" d="M524.5,291.5A6,6,0,1,1,512.5,291.5A6,6,0,1,1,524.5,291.5"></path><path id="kity_path_237" fill="none" stroke="gray"></path></g><path id="node_outline7" fill="none" stroke="none" d="M529.5,280.5h506a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-506a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text7" fill="black"><text id="kity_text_117" text-rendering="inherit" font-size="12" dy=".8em" y="285.5" x="534.5">为了确保这个Mode生效，你要确保至少添加一个souce或者timer或者observer到该Mode中</text></g></g><g id="minder_node10"><g id="node_expander21" style="cursor: pointer;"><path id="kity_path_281" fill="white" stroke="gray" d="M440.5,499.5A6,6,0,1,1,428.5,499.5A6,6,0,1,1,440.5,499.5"></path><path id="kity_path_282" fill="none" stroke="gray" d="M430,499.5L439,499.5"></path></g><path id="node_outline22" fill="none" stroke="none" d="M445.5,488.5h34a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-34a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text22" fill="black"><text id="kity_text_147" text-rendering="inherit" font-size="12" dy=".8em" y="493.5" x="450.5">组成</text></g></g><g id="minder_node11"><g id="node_expander9" style="cursor: pointer;"><path id="kity_path_245" fill="white" stroke="gray" d="M524.5,343.5A6,6,0,1,1,512.5,343.5A6,6,0,1,1,524.5,343.5"></path><path id="kity_path_246" fill="none" stroke="gray" d="M514,343.5L523,343.5"></path></g><path id="node_outline10" fill="none" stroke="none" d="M529.5,332.5h130a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-130a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text10" fill="black"><text id="kity_text_123" text-rendering="inherit" font-size="12" dy=".8em" y="337.5" x="534.5">CFRunLoopObserver</text></g></g><g id="minder_node12"><g id="node_expander8" style="cursor: pointer;" display="none"><path id="kity_path_242" fill="white" stroke="gray" d="M704.5,343.5A6,6,0,1,1,692.5,343.5A6,6,0,1,1,704.5,343.5"></path><path id="kity_path_243" fill="none" stroke="gray"></path></g><path id="node_outline9" fill="none" stroke="none" d="M709.5,332.5h424a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-424a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text9" fill="black"><text id="kity_text_121" text-rendering="inherit" font-size="12" dy=".8em" y="337.5" x="714.5">CFRunLoopObserver 是观察者，可以观察RunLoop的各种状态，并抛出回调</text></g></g><g id="minder_node13"><g id="node_expander18" style="cursor: pointer;"><path id="kity_path_272" fill="white" stroke="gray" d="M524.5,519.5A6,6,0,1,1,512.5,519.5A6,6,0,1,1,524.5,519.5"></path><path id="kity_path_273" fill="none" stroke="gray" d="M514,519.5L523,519.5"></path></g><path id="node_outline19" fill="none" stroke="none" d="M529.5,508.5h117a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-117a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text19" fill="black"><text id="kity_text_141" text-rendering="inherit" font-size="12" dy=".8em" y="513.5" x="534.5">CFRunLoopSource</text></g></g><g id="minder_node14"><g id="node_expander14" style="cursor: pointer;"><path id="kity_path_260" fill="white" stroke="gray" d="M691.5,435.5A6,6,0,1,1,679.5,435.5A6,6,0,1,1,691.5,435.5"></path><path id="kity_path_261" fill="none" stroke="gray" d="M681,435.5L690,435.5"></path></g><path id="node_outline15" fill="none" stroke="none" d="M696.5,424.5h124a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-124a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text15" fill="black"><text id="kity_text_133" text-rendering="inherit" font-size="12" dy=".8em" y="429.5" x="701.5">CFRunLoopSource0</text></g></g><g id="minder_node15"><g id="node_expander10" style="cursor: pointer;" display="none"><path id="kity_path_248" fill="white" stroke="gray" d="M865.5,396.5A6,6,0,1,1,853.5,396.5A6,6,0,1,1,865.5,396.5"></path><path id="kity_path_249" fill="none" stroke="gray"></path></g><path id="node_outline11" fill="none" stroke="none" d="M870.5,385.5h458a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-458a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text11" fill="black"><text id="kity_text_125" text-rendering="inherit" font-size="12" dy=".8em" y="390.5" x="875.5">非基于port的事件，不能主动触发事件，主要是APP内部事件，如CFSocket&#xa0;UIEvent</text></g></g><g id="minder_node16"><g id="node_expander13" style="cursor: pointer;"><path id="kity_path_257" fill="white" stroke="gray" d="M865.5,474.5A6,6,0,1,1,853.5,474.5A6,6,0,1,1,865.5,474.5"></path><path id="kity_path_258" fill="none" stroke="gray" d="M855,474.5L864,474.5"></path></g><path id="node_outline14" fill="none" stroke="none" d="M870.5,463.5h58a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-58a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text14" fill="black"><text id="kity_text_131" text-rendering="inherit" font-size="12" dy=".8em" y="468.5" x="875.5">如何使用</text></g></g><g id="minder_node17"><g id="node_expander11" style="cursor: pointer;" display="none"><path id="kity_path_251" fill="white" stroke="gray" d="M973.5,448.5A6,6,0,1,1,961.5,448.5A6,6,0,1,1,973.5,448.5"></path><path id="kity_path_252" fill="none" stroke="gray"></path></g><path id="node_outline12" fill="none" stroke="none" d="M978.5,437.5h377a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-377a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text12" fill="black"><text id="kity_text_127" text-rendering="inherit" font-size="12" dy=".8em" y="442.5" x="983.5">1、将source标记为待处理。调用CFRunLoopSourceSignal(source)</text></g></g><g id="minder_node18"><g id="node_expander12" style="cursor: pointer;" display="none"><path id="kity_path_254" fill="white" stroke="gray" d="M973.5,500.5A6,6,0,1,1,961.5,500.5A6,6,0,1,1,973.5,500.5"></path><path id="kity_path_255" fill="none" stroke="gray"></path></g><path id="node_outline13" fill="none" stroke="none" d="M978.5,489.5h433a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-433a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text13" fill="black"><text id="kity_text_129" text-rendering="inherit" font-size="12" dy=".8em" y="494.5" x="983.5">2、唤醒RunLoop,让其处理这个事件。手动调用CFRunLoopWakeUp(runloop)</text></g></g><g id="minder_node19"><g id="node_expander16" style="cursor: pointer;"><path id="kity_path_266" fill="white" stroke="gray" d="M691.5,552.5A6,6,0,1,1,679.5,552.5A6,6,0,1,1,691.5,552.5"></path><path id="kity_path_267" fill="none" stroke="gray" d="M681,552.5L690,552.5"></path></g><path id="node_outline17" fill="none" stroke="none" d="M696.5,541.5h124a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-124a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text17" fill="black"><text id="kity_text_137" text-rendering="inherit" font-size="12" dy=".8em" y="546.5" x="701.5">CFRunLoopSource1</text></g></g><g id="minder_node20"><g id="node_expander15" style="cursor: pointer;" display="none"><path id="kity_path_263" fill="white" stroke="gray" d="M865.5,552.5A6,6,0,1,1,853.5,552.5A6,6,0,1,1,865.5,552.5"></path><path id="kity_path_264" fill="none" stroke="gray"></path></g><path id="node_outline16" fill="none" stroke="none" d="M870.5,541.5h468a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-468a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text16" fill="black"><text id="kity_text_135" text-rendering="inherit" font-size="12" dy=".8em" y="546.5" x="875.5">基于Port，能主动唤醒RunLoop的线程通过内核和其他线程通信，接收，分发系统事件</text></g></g><g id="minder_node21"><g id="node_expander17" style="cursor: pointer;" display="none"><path id="kity_path_269" fill="white" stroke="gray" d="M691.5,604.5A6,6,0,1,1,679.5,604.5A6,6,0,1,1,691.5,604.5"></path><path id="kity_path_270" fill="none" stroke="gray"></path></g><path id="node_outline18" fill="none" stroke="none" d="M696.5,593.5h213a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-213a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text18" fill="black"><text id="kity_text_139" text-rendering="inherit" font-size="12" dy=".8em" y="598.5" x="701.5">可以被添加到多个runloop mode中去</text></g></g><g id="minder_node22"><g id="node_expander20" style="cursor: pointer;"><path id="kity_path_278" fill="white" stroke="gray" d="M524.5,655.5A6,6,0,1,1,512.5,655.5A6,6,0,1,1,524.5,655.5"></path><path id="kity_path_279" fill="none" stroke="gray" d="M514,655.5L523,655.5"></path></g><path id="node_outline21" fill="none" stroke="none" d="M529.5,644.5h107a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-107a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text21" fill="black"><text id="kity_text_145" text-rendering="inherit" font-size="12" dy=".8em" y="649.5" x="534.5">CFRunLoopTimer</text></g></g><g id="minder_node23"><g id="node_expander19" style="cursor: pointer;" display="none"><path id="kity_path_275" fill="white" stroke="gray" d="M681.5,655.5A6,6,0,1,1,669.5,655.5A6,6,0,1,1,681.5,655.5"></path><path id="kity_path_276" fill="none" stroke="gray"></path></g><path id="node_outline20" fill="none" stroke="none" d="M686.5,644.5h326a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-326a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text20" fill="black"><text id="kity_text_143" text-rendering="inherit" font-size="12" dy=".8em" y="649.5" x="691.5">CFRunLoopTimer 是定时器，可以在设定的时间点抛出回调</text></g></g><g id="minder_node24"><g id="node_expander24" style="cursor: pointer;"><path id="kity_path_290" fill="white" stroke="gray" d="M440.5,733.5A6,6,0,1,1,428.5,733.5A6,6,0,1,1,440.5,733.5"></path><path id="kity_path_291" fill="none" stroke="gray" d="M430,733.5L439,733.5"></path></g><path id="node_outline25" fill="none" stroke="none" d="M445.5,722.5h69a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-69a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text25" fill="black"><text id="kity_text_153" text-rendering="inherit" font-size="12" dy=".8em" y="727.5" x="450.5">主要mode</text></g></g><g id="minder_node25"><g id="node_expander22" style="cursor: pointer;" display="none"><path id="kity_path_284" fill="white" stroke="gray" d="M559.5,707.5A6,6,0,1,1,547.5,707.5A6,6,0,1,1,559.5,707.5"></path><path id="kity_path_285" fill="none" stroke="gray"></path></g><path id="node_outline23" fill="none" stroke="none" d="M564.5,696.5h160a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-160a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text23" fill="black"><text id="kity_text_149" text-rendering="inherit" font-size="12" dy=".8em" y="701.5" x="569.5">kCFRunLoopDefaultMode</text></g></g><g id="minder_node26"><g id="node_expander23" style="cursor: pointer;" display="none"><path id="kity_path_287" fill="white" stroke="gray" d="M559.5,759.5A6,6,0,1,1,547.5,759.5A6,6,0,1,1,559.5,759.5"></path><path id="kity_path_288" fill="none" stroke="gray"></path></g><path id="node_outline24" fill="none" stroke="none" d="M564.5,748.5h155a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-155a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text24" fill="black"><text id="kity_text_151" text-rendering="inherit" font-size="12" dy=".8em" y="753.5" x="569.5">UITrackingRunLoopMode</text></g></g><g id="minder_node27"><g id="node_expander27" style="cursor: pointer;"><path id="kity_path_299" fill="white" stroke="gray" d="M241.5,837.5A6,6,0,1,1,229.5,837.5A6,6,0,1,1,241.5,837.5"></path><path id="kity_path_300" fill="none" stroke="gray" d="M231,837.5L240,837.5"></path></g><path id="node_outline28" fill="rgb(238, 243, 246)" stroke="rgb(115, 161, 191)" d="M245.5,824.5h80a3,3,0,0,1,3,3v20a3,3,0,0,1,-3,3h-80a3,3,0,0,1,-3,-3v-20a3,3,0,0,1,3,-3z" stroke-width="1"></path><g id="node_text28" fill="black"><text id="kity_text_159" text-rendering="inherit" font-size="14" dy=".8em" y="830.5" x="262.5">thread</text></g></g><g id="minder_node28"><g id="node_expander26" style="cursor: pointer;" display="none"><path id="kity_path_296" fill="white" stroke="gray" d="M368.5,837.5A6,6,0,1,1,356.5,837.5A6,6,0,1,1,368.5,837.5"></path><path id="kity_path_297" fill="none" stroke="gray"></path></g><path id="node_outline27" fill="none" stroke="none" d="M373.5,826.5h157a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-157a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text27" fill="black"><text id="kity_text_157" text-rendering="inherit" font-size="12" dy=".8em" y="831.5" x="378.5">一个线程对应一个RunLoop</text></g></g><g id="minder_node29" opacity="1"><g id="node_expander33" style="cursor: pointer;"><path id="kity_path_317" fill="white" stroke="gray" d="M340.5,993.5A6,6,0,1,1,328.5,993.5A6,6,0,1,1,340.5,993.5"></path><path id="kity_path_318" fill="none" stroke="gray" d="M330,993.5L339,993.5"></path></g><path id="node_outline34" fill="rgb(238, 243, 246)" stroke="rgb(115, 161, 191)" d="M344.5,980.5h90a3,3,0,0,1,3,3v20a3,3,0,0,1,-3,3h-90a3,3,0,0,1,-3,-3v-20a3,3,0,0,1,3,-3z" stroke-width="1"></path><g id="node_text34" fill="black"><text id="kity_text_171" text-rendering="inherit" font-size="14" dy=".8em" y="986.5" x="361.5">基本概念</text></g></g><g id="minder_node35"><g id="node_expander38" style="cursor: pointer;"><path id="kity_path_332" fill="white" stroke="gray" d="M255.5,1235.5A6,6,0,1,1,243.5,1235.5A6,6,0,1,1,255.5,1235.5"></path><path id="kity_path_333" fill="none" stroke="gray" d="M245,1235.5L254,1235.5"></path></g><path id="node_outline39" fill="rgb(238, 243, 246)" stroke="rgb(115, 161, 191)" d="M259.5,1222.5h174a3,3,0,0,1,3,3v20a3,3,0,0,1,-3,3h-174a3,3,0,0,1,-3,-3v-20a3,3,0,0,1,3,-3z" stroke-width="1"></path><g id="node_text39" fill="black"><text id="kity_text_181" text-rendering="inherit" font-size="14" dy=".8em" y="1228.5" x="276.5">什么时候使用Runloop</text></g></g><g id="minder_node36"><g id="node_expander34" style="cursor: pointer;" display="none"><path id="kity_path_320" fill="white" stroke="gray" d="M476.5,1157.5A6,6,0,1,1,464.5,1157.5A6,6,0,1,1,476.5,1157.5"></path><path id="kity_path_321" fill="none" stroke="gray"></path></g><path id="node_outline35" fill="none" stroke="none" d="M481.5,1146.5h130a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-130a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text35" fill="black"><text id="kity_text_173" text-rendering="inherit" font-size="12" dy=".8em" y="1151.5" x="486.5">需要和其他线程通信时</text></g></g><g id="minder_node37"><g id="node_expander35" style="cursor: pointer;" display="none"><path id="kity_path_323" fill="white" stroke="gray" d="M476.5,1209.5A6,6,0,1,1,464.5,1209.5A6,6,0,1,1,476.5,1209.5"></path><path id="kity_path_324" fill="none" stroke="gray"></path></g><path id="node_outline36" fill="none" stroke="none" d="M481.5,1198.5h147a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-147a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text36" fill="black"><text id="kity_text_175" text-rendering="inherit" font-size="12" dy=".8em" y="1203.5" x="486.5">需要在子线程中使用timer</text></g></g><g id="minder_node38"><g id="node_expander36" style="cursor: pointer;" display="none"><path id="kity_path_326" fill="white" stroke="gray" d="M476.5,1261.5A6,6,0,1,1,464.5,1261.5A6,6,0,1,1,476.5,1261.5"></path><path id="kity_path_327" fill="none" stroke="gray"></path></g><path id="node_outline37" fill="none" stroke="none" d="M481.5,1250.5h180a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-180a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text37" fill="black"><text id="kity_text_177" text-rendering="inherit" font-size="12" dy=".8em" y="1255.5" x="486.5">使用performSelector...系列API</text></g></g><g id="minder_node39"><g id="node_expander37" style="cursor: pointer;" display="none"><path id="kity_path_329" fill="white" stroke="gray" d="M476.5,1313.5A6,6,0,1,1,464.5,1313.5A6,6,0,1,1,476.5,1313.5"></path><path id="kity_path_330" fill="none" stroke="gray"></path></g><path id="node_outline38" fill="none" stroke="none" d="M481.5,1302.5h94a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-94a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text38" fill="black"><text id="kity_text_179" text-rendering="inherit" font-size="12" dy=".8em" y="1307.5" x="486.5">执行周期性任务</text></g></g><g id="minder_node40"><g id="node_expander39" style="cursor: pointer;"><path id="kity_path_340" fill="white" stroke="gray" d="M255.5,1798.5A6,6,0,1,1,243.5,1798.5A6,6,0,1,1,255.5,1798.5"></path><path id="kity_path_341" fill="none" stroke="gray" d="M245,1798.5L254,1798.5"></path></g><path id="node_outline40" fill="rgb(238, 243, 246)" stroke="rgb(115, 161, 191)" d="M259.5,1785.5h146a3,3,0,0,1,3,3v20a3,3,0,0,1,-3,3h-146a3,3,0,0,1,-3,-3v-20a3,3,0,0,1,3,-3z" stroke-width="1"></path><g id="node_text40" fill="black"><text id="kity_text_337" text-rendering="inherit" font-size="14" dy=".8em" y="1791.5" x="276.5">Runloop启动原理</text></g></g><g id="minder_node43"><g id="node_expander42" style="cursor: pointer;" display="none"><path id="kity_path_405" fill="white" stroke="gray" d="M448.5,1402.5A6,6,0,1,1,436.5,1402.5A6,6,0,1,1,448.5,1402.5"></path><path id="kity_path_406" fill="none" stroke="gray"></path></g><path id="node_outline43" fill="none" stroke="none" d="M453.5,1364.5h566a5,5,0,0,1,5,5v66a5,5,0,0,1,-5,5h-566a5,5,0,0,1,-5,-5v-66a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text43" fill="black"><text id="kity_text_402" text-rendering="inherit" font-size="12" dy=".8em" y="1369.5" x="458.5">1、/// 1. 通知Observers，即将进入RunLoop</text><text id="kity_text_474" text-rendering="inherit" font-size="12" dy=".8em" y="1387.5" x="458.5">/// 此处有Observer会创建AutoreleasePool: _objc_autoreleasePoolPush();</text><text id="kity_text_497" text-rendering="inherit" font-size="12" dy=".8em" y="1405.5" x="458.5">__CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__(kCFRunLoopEntry);</text><text id="kity_text_498" text-rendering="inherit" font-size="12" dy=".8em" y="1423.5" x="458.5">do {</text></g></g><g id="minder_node46"><g id="node_expander45" style="cursor: pointer;" display="none"><path id="kity_path_429" fill="white" stroke="gray" d="M448.5,1490.5A6,6,0,1,1,436.5,1490.5A6,6,0,1,1,448.5,1490.5"></path><path id="kity_path_430" fill="none" stroke="gray"></path></g><path id="node_outline46" fill="none" stroke="none" d="M453.5,1470.5h611a5,5,0,0,1,5,5v30a5,5,0,0,1,-5,5h-611a5,5,0,0,1,-5,-5v-30a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text46" fill="black"><text id="kity_text_426" text-rendering="inherit" font-size="12" dy=".8em" y="1475.5" x="458.5">/// 2. 通知 Observers: 即将触发 Timer 回调。</text><text id="kity_text_479" text-rendering="inherit" font-size="12" dy=".8em" y="1493.5" x="458.5">__CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__(kCFRunLoopBeforeTimers);</text></g></g><g id="minder_node47"><g id="node_expander46" style="cursor: pointer;" display="none"><path id="kity_path_437" fill="white" stroke="gray" d="M448.5,1569.5A6,6,0,1,1,436.5,1569.5A6,6,0,1,1,448.5,1569.5"></path><path id="kity_path_438" fill="none" stroke="gray"></path></g><path id="node_outline47" fill="none" stroke="none" d="M453.5,1540.5h621a5,5,0,0,1,5,5v48a5,5,0,0,1,-5,5h-621a5,5,0,0,1,-5,-5v-48a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text47" fill="black"><text id="kity_text_434" text-rendering="inherit" font-size="12" dy=".8em" y="1545.5" x="458.5">/// 3. 通知 Observers: 即将触发 Source (非基于port的,Source0) 回调。</text><text id="kity_text_481" text-rendering="inherit" font-size="12" dy=".8em" y="1563.5" x="458.5">__CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__(kCFRunLoopBeforeSources);</text><text id="kity_text_496" text-rendering="inherit" font-size="12" dy=".8em" y="1581.5" x="458.5">__CFRUNLOOP_IS_CALLING_OUT_TO_A_BLOCK__(block);</text></g></g><g id="minder_node48"><g id="node_expander47" style="cursor: pointer;" display="none"><path id="kity_path_445" fill="white" stroke="gray" d="M448.5,1657.5A6,6,0,1,1,436.5,1657.5A6,6,0,1,1,448.5,1657.5"></path><path id="kity_path_446" fill="none" stroke="gray"></path></g><path id="node_outline48" fill="none" stroke="none" d="M453.5,1628.5h490a5,5,0,0,1,5,5v48a5,5,0,0,1,-5,5h-490a5,5,0,0,1,-5,-5v-48a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text48" fill="black"><text id="kity_text_442" text-rendering="inherit" font-size="12" dy=".8em" y="1633.5" x="458.5">/// 4. 触发 Source0 (非基于port的) 回调。</text><text id="kity_text_482" text-rendering="inherit" font-size="12" dy=".8em" y="1651.5" x="458.5">__CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__(source0);</text><text id="kity_text_513" text-rendering="inherit" font-size="12" dy=".8em" y="1669.5" x="458.5">__CFRUNLOOP_IS_CALLING_OUT_TO_A_BLOCK__(block);</text></g></g><g id="minder_node49"><g id="node_expander48" style="cursor: pointer;" display="none"><path id="kity_path_453" fill="white" stroke="gray" d="M448.5,1745.5A6,6,0,1,1,436.5,1745.5A6,6,0,1,1,448.5,1745.5"></path><path id="kity_path_454" fill="none" stroke="gray"></path></g><path id="node_outline49" fill="none" stroke="none" d="M453.5,1716.5h623a5,5,0,0,1,5,5v48a5,5,0,0,1,-5,5h-623a5,5,0,0,1,-5,-5v-48a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text49" fill="black"><text id="kity_text_450" text-rendering="inherit" font-size="12" dy=".8em" y="1721.5" x="458.5">/// 5. 通知Observers，即将进入休眠</text><text id="kity_text_483" text-rendering="inherit" font-size="12" dy=".8em" y="1739.5" x="458.5">/// 此处有Observer释放并新建AutoreleasePool: _objc_autoreleasePoolPop(); _objc_autoreleasePoolPush();</text><text id="kity_text_528" text-rendering="inherit" font-size="12" dy=".8em" y="1757.5" x="458.5">__CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__(kCFRunLoopBeforeWaiting);</text></g></g><g id="minder_node50"><g id="node_expander49" style="cursor: pointer;" display="none"><path id="kity_path_461" fill="white" stroke="gray" d="M448.5,1824.5A6,6,0,1,1,436.5,1824.5A6,6,0,1,1,448.5,1824.5"></path><path id="kity_path_462" fill="none" stroke="gray"></path></g><path id="node_outline50" fill="none" stroke="none" d="M453.5,1804.5h207a5,5,0,0,1,5,5v30a5,5,0,0,1,-5,5h-207a5,5,0,0,1,-5,-5v-30a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text50" fill="black"><text id="kity_text_458" text-rendering="inherit" font-size="12" dy=".8em" y="1809.5" x="458.5">/// 6. sleep to wait msg.</text><text id="kity_text_484" text-rendering="inherit" font-size="12" dy=".8em" y="1827.5" x="458.5">mach_msg() -&gt; mach_msg_trap();</text></g></g><g id="minder_node51"><g id="node_expander50" style="cursor: pointer;" display="none"><path id="kity_path_469" fill="white" stroke="gray" d="M448.5,1894.5A6,6,0,1,1,436.5,1894.5A6,6,0,1,1,448.5,1894.5"></path><path id="kity_path_470" fill="none" stroke="gray"></path></g><path id="node_outline51" fill="none" stroke="none" d="M453.5,1874.5h610a5,5,0,0,1,5,5v30a5,5,0,0,1,-5,5h-610a5,5,0,0,1,-5,-5v-30a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text51" fill="black"><text id="kity_text_466" text-rendering="inherit" font-size="12" dy=".8em" y="1879.5" x="458.5">/// 7. 通知Observers，线程被唤醒</text><text id="kity_text_488" text-rendering="inherit" font-size="12" dy=".8em" y="1897.5" x="458.5">__CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__(kCFRunLoopAfterWaiting);</text></g></g><g id="minder_node52"><g id="node_expander51" style="cursor: pointer;" display="none"><path id="kity_path_508" fill="white" stroke="gray" d="M448.5,1964.5A6,6,0,1,1,436.5,1964.5A6,6,0,1,1,448.5,1964.5"></path><path id="kity_path_509" fill="none" stroke="gray"></path></g><path id="node_outline52" fill="none" stroke="none" d="M453.5,1944.5h459a5,5,0,0,1,5,5v30a5,5,0,0,1,-5,5h-459a5,5,0,0,1,-5,-5v-30a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text52" fill="black"><text id="kity_text_502" text-rendering="inherit" font-size="12" dy=".8em" y="1949.5" x="458.5">/// 8. 如果是被Timer唤醒的，回调Timer</text><text id="kity_text_503" text-rendering="inherit" font-size="12" dy=".8em" y="1967.5" x="458.5">__CFRUNLOOP_IS_CALLING_OUT_TO_A_TIMER_CALLBACK_FUNCTION__(timer);</text></g></g><g id="minder_node53"><g id="node_expander52" style="cursor: pointer;" display="none"><path id="kity_path_523" fill="white" stroke="gray" d="M448.5,2070.5A6,6,0,1,1,436.5,2070.5A6,6,0,1,1,448.5,2070.5"></path><path id="kity_path_524" fill="none" stroke="gray"></path></g><path id="node_outline53" fill="none" stroke="none" d="M453.5,2014.5h538a5,5,0,0,1,5,5v102a5,5,0,0,1,-5,5h-538a5,5,0,0,1,-5,-5v-102a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text53" fill="black"><text id="kity_text_517" text-rendering="inherit" font-size="12" dy=".8em" y="2019.5" x="458.5">/// 9. 如果是被dispatch唤醒的，执行所有调用 dispatch_async 等方法放入main queue 的 block</text><text id="kity_text_518" text-rendering="inherit" font-size="12" dy=".8em" y="2037.5" x="458.5">__CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__(dispatched_block);</text><text id="kity_text_519" text-rendering="inherit" font-size="12" dy=".8em" y="2055.5" x="458.5"></text><text id="kity_text_520" text-rendering="inherit" font-size="12" dy=".8em" y="2073.5" x="458.5">/// 9. 如果如果Runloop是被 Source1 (基于port的) 的事件唤醒了，处理这个事件</text><text id="kity_text_525" text-rendering="inherit" font-size="12" dy=".8em" y="2091.5" x="458.5">__CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__(source1);</text><text id="kity_text_541" text-rendering="inherit" font-size="12" dy=".8em" y="2109.5" x="458.5">} while (...);</text></g></g><g id="kity_g_12" display="none"><path id="kity_path_13" fill="none" stroke="rgb(66, 94, 112)" d="M626.5,1606.5h11a5,5,0,0,1,5,5v318a5,5,0,0,1,-5,5h-11a5,5,0,0,1,-5,-5v-318a5,5,0,0,1,5,-5z" stroke-width="5"></path></g><g id="minder_node54"><g id="node_expander53" style="cursor: pointer;" display="none"><path id="kity_path_538" fill="white" stroke="gray" d="M448.5,2194.5A6,6,0,1,1,436.5,2194.5A6,6,0,1,1,448.5,2194.5"></path><path id="kity_path_539" fill="none" stroke="gray"></path></g><path id="node_outline54" fill="none" stroke="none" d="M453.5,2156.5h557a5,5,0,0,1,5,5v66a5,5,0,0,1,-5,5h-557a5,5,0,0,1,-5,-5v-66a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text54" fill="black"><text id="kity_text_532" text-rendering="inherit" font-size="12" dy=".8em" y="2161.5" x="458.5">/// 10. 通知Observers，即将退出RunLoop</text><text id="kity_text_533" text-rendering="inherit" font-size="12" dy=".8em" y="2179.5" x="458.5">/// 此处有Observer释放AutoreleasePool: _objc_autoreleasePoolPop();</text><text id="kity_text_534" text-rendering="inherit" font-size="12" dy=".8em" y="2197.5" x="458.5">__CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__(kCFRunLoopExit);</text><text id="kity_text_535" text-rendering="inherit" font-size="12" dy=".8em" y="2215.5" x="458.5">}</text></g></g><g id="minder_node30"><g id="node_expander28" style="cursor: pointer;" display="none"><path id="kity_path_302" fill="white" stroke="gray" d="M477.5,889.5A6,6,0,1,1,465.5,889.5A6,6,0,1,1,477.5,889.5"></path><path id="kity_path_303" fill="none" stroke="gray"></path></g><path id="node_outline29" fill="none" stroke="none" d="M482.5,878.5h677a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-677a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text29" fill="black"><text id="kity_text_161" text-rendering="inherit" font-size="12" dy=".8em" y="883.5" x="487.5">RunLoop是线程基础架构的一部分。RunLoop存在的目的是让线程在没有任务处理的时候进入休眠，在有任务处理的时候运行</text></g></g><g id="minder_node31"><g id="node_expander29" style="cursor: pointer;" display="none"><path id="kity_path_305" fill="white" stroke="gray" d="M477.5,941.5A6,6,0,1,1,465.5,941.5A6,6,0,1,1,477.5,941.5"></path><path id="kity_path_306" fill="none" stroke="gray"></path></g><path id="node_outline30" fill="none" stroke="none" d="M482.5,930.5h313a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-313a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text30" fill="black"><text id="kity_text_163" text-rendering="inherit" font-size="12" dy=".8em" y="935.5" x="487.5">RunLoop不是完全自管理的，需要你在适当的时候启动。</text></g></g><g id="minder_node32"><g id="node_expander30" style="cursor: pointer;" display="none"><path id="kity_path_308" fill="white" stroke="gray" d="M477.5,993.5A6,6,0,1,1,465.5,993.5A6,6,0,1,1,477.5,993.5"></path><path id="kity_path_309" fill="none" stroke="gray"></path></g><path id="node_outline31" fill="none" stroke="none" d="M482.5,982.5h340a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-340a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text31" fill="black"><text id="kity_text_165" text-rendering="inherit" font-size="12" dy=".8em" y="987.5" x="487.5">Cocoa和Core Foundation框架都提供了RunLoop相关的API</text></g></g><g id="minder_node33"><g id="node_expander31" style="cursor: pointer;" display="none"><path id="kity_path_311" fill="white" stroke="gray" d="M477.5,1045.5A6,6,0,1,1,465.5,1045.5A6,6,0,1,1,477.5,1045.5"></path><path id="kity_path_312" fill="none" stroke="gray"></path></g><path id="node_outline32" fill="none" stroke="none" d="M482.5,1034.5h473a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-473a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z"></path><g id="node_text32" fill="black"><text id="kity_text_167" text-rendering="inherit" font-size="12" dy=".8em" y="1039.5" x="487.5">你不需要自己创建RunLoop对象。每个线程，包括主线程都有一个对应的RunLoop对象</text></g></g><g id="minder_node34"><g id="node_expander32" style="cursor: pointer;" display="none"><path id="kity_path_314" fill="white" stroke="gray" d="M477.5,1097.5A6,6,0,1,1,465.5,1097.5A6,6,0,1,1,477.5,1097.5"></path><path id="kity_path_315" fill="none" stroke="gray"></path></g><path id="node_outline33" fill="none" stroke="none" d="M482.5,1086.5h462a5,5,0,0,1,5,5v12a5,5,0,0,1,-5,5h-462a5,5,0,0,1,-5,-5v-12a5,5,0,0,1,5,-5z" stroke-width="3"></path><g id="node_text33" fill="black"><text id="kity_text_169" text-rendering="inherit" font-size="12" dy=".8em" y="1091.5" x="487.5">只有子线程的RunLoop需要手动启动，主线程的RunLoop在App启动时就已经运行了</text></g></g></g></g></svg>